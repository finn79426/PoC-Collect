# CVE-2020-8597 pppd Buffer Overflow

# Create a Lab

You need 2 Linux VMs, I'm tested on Ubuntu 16.04.

Recommend to use Linked Clone to create 2nd VM, It will save a lot of time and disk usage.

# Set Server-Side Environment

The following script will install `pppoe-server`:

```
sudo ./PPPoEServer_setup.sh
```

Note: The default pppd in Ubuntu 16.04 are the patched version, You need to install unpatched version in most cases.

```
sudo ./pppd_install.sh
```

# PoC Usage

1. Set the attacker(client), target(server) MAC address
2. Set the network adapter
3. server: `pppoe-server -I <ens33 or eth0>`
4. client: `pppoeconf`, Username: `cve`
5. `python poc.py`

Run the `poc.py`, server's pppd session will crash, You can check Error Log in `/var/log/pppoe-server-log`.

# Info

```
> file pppd\(arm\)
pppd(arm): ELF 32-bit LSB executable, ARM, EABI5 version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux-armhf.so.3, for GNU/Linux 3.2.0, BuildID[sha1]=3bbc344b39e2c46fbb49b6b56dfce31c349ae3dc, with debug_info, not stripped
```

# Ref

https://github.com/WinMin/CVE-2020-8597
https://github.com/marcinguy/CVE-2020-8597
https://www.anquanke.com/post/id/200639
